---
description:
globs:
alwaysApply: false
---
# Database Schema

## User Table
Table: `users`
- `id` (Primary Key) - Incremental ID
- `telegram_id` (Unique) - Telegram user ID
- `username` - Telegram username
- `first_name` - User's first name
- `last_name` - User's last name
- `balance` - Current user balance
- `created_at` - Registration timestamp
- `last_active` - Last activity timestamp
- `is_admin` - Admin status flag

## Product Table
Table: `products`
- `id` (Primary Key) - Product ID
- `name` - Product name
- `description` - Product description
- `price` - Product price
- `category_id` - Reference to category
- `file_path` - Path to source code file
- `preview_image` - Image URL/path
- `created_at` - Creation timestamp
- `updated_at` - Last update timestamp
- `is_active` - Availability status

## Category Table
Table: `categories`
- `id` (Primary Key) - Category ID
- `name` - Category name
- `description` - Category description

## Transaction Table
Table: `transactions`
- `id` (Primary Key) - Transaction ID
- `user_id` - Reference to user
- `amount` - Transaction amount
- `type` - Transaction type (deposit, purchase, refund)
- `description` - Transaction description
- `created_at` - Transaction timestamp
- `payment_id` - External payment reference (for deposits)
- `product_id` - Product reference (for purchases)

## Purchase Table
Table: `purchases`
- `id` (Primary Key) - Purchase ID
- `user_id` - Reference to user
- `product_id` - Reference to product
- `transaction_id` - Reference to transaction
- `purchase_price` - Price at time of purchase
- `created_at` - Purchase timestamp
- `delivery_status` - Status of source code delivery

## Payment Table
Table: `payments`
- `id` (Primary Key) - Payment ID
- `user_id` - Reference to user
- `invoice_id` - Crypto Pay invoice ID
- `status` - Payment status
- `amount` - Payment amount
- `asset` - Cryptocurrency used
- `created_at` - Creation timestamp
- `paid_at` - Payment timestamp
- `transaction_id` - Reference to transaction (if completed)
